-- Create "manifest_layers" table
CREATE TABLE
    "manifest_layers" (
        "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
        "media_type" character varying NOT NULL,
        "digest" character varying NOT NULL,
        "size" integer NOT NULL,
        "annotations" jsonb NOT NULL,
        "manifest_manifest_layers" bigint NULL,
        PRIMARY KEY ("id"),
        CONSTRAINT "manifest_layers_manifests_manifest_layers" FOREIGN KEY ("manifest_manifest_layers") REFERENCES "manifests" ("id") ON UPDATE NO ACTION ON DELETE SET NULL
    );

-- Create index "manifestlayer_digest_manifest_manifest_layers" to table: "manifest_layers"
CREATE UNIQUE INDEX "manifestlayer_digest_manifest_manifest_layers" ON "manifest_layers" ("digest", "manifest_manifest_layers");